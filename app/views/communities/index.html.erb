
<h1>Communities</h1>

<%= search_form_for @q, url: search_communities_path do |f| %>
  <%= f.label :name_cont, 'コミュニティ名で検索'%>
  <%= f.search_field :name_cont %>
  <br>
  <%= f.submit '検索' %>
<% end %>

<table class="table table-hover">
  <thead>
    <tr>
      <th>コミュニティ名</th>
      <th>コミュニティ説明</th>
      <th>作成者</th>
      <th>作成日時</th>
      <th>コメント<span class="glyphicon glyphicon-volume-up" aria-hidden="true"></span></th>
      <th>いいね<span class="glyphicon glyphicon-heart" aria-hidden="true"></span></th>
      <th>参加人数<span class="glyphicon glyphicon-user" aria-hidden="true"></span></th>
    </tr>
  </thead>

  <tbody>
    <% @communities.each do |community| %>
      <tr>
        <td><%= community.name %></td>
        <td><%= community.description %></td>
        <td><%= community.user.name %></td>
        <td><%= community.created_at.strftime("%Y-%m-%d %H:%M") %></td>
        <td><%= community.comments.count%></td>
        <td><%= community.favorites.count%></td>
        <td><%= community.members.count%></td>

        <% if user_signed_in? %>
       <td><%= link_to '詳しく', community,class: 'btn btn-info' if community.comments.count < 30 %></td>
       <% end %>
         <% if community.user == current_user || current_user.admin?  %>
        <td><%= link_to '編集', edit_community_path(community), class: 'btn btn-success' %></td>
        <td><%= link_to '削除', community,  class: 'btn btn-warning',method: :delete, data: { confirm: '本当に消しちゃっていいの?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>


<%= link_to 'コミュニティを作る', new_community_path, class: 'btn btn-default' %>
